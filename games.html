<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play to Win - MicroEarn</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Monetag SDK - CORRECT URL -->
    <script src='//libtl.com/sdk.js' data-zone='10496645' data-sdk='show_10496645'></script>
    <script src="ads.js?v=3"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 80px;
            /* Space for sticky ad */
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .daily-limit {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px;
            border-radius: 12px;
            color: white;
            text-align: center;
            margin-bottom: 20px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .game-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .game-card:active {
            transform: scale(0.95);
        }

        .game-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .game-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .game-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .game-reward {
            color: #10b981;
            font-size: 12px;
            font-weight: 600;
        }

        .game-plays {
            color: #666;
            font-size: 11px;
            margin-top: 5px;
        }

        .game-plays.exhausted {
            color: #ff6b6b;
            font-weight: 600;
        }

        .game-card.disabled .game-plays {
            color: #ff6b6b;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.15);
            /* Light semi-transparent */
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 15px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 500;
            cursor: pointer;
            z-index: 100;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .back-btn:active {
            transform: scale(0.95);
        }

        /* Game Modal - Full screen scrollable layout */
        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            flex-direction: column;
            overflow-y: auto;
        }

        .game-modal.show {
            display: flex;
        }

        .game-modal-inner {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100%;
            padding-bottom: 80px;
        }

        .game-header {
            position: sticky;
            top: 0;
            width: 100%;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            margin-bottom: 20px;
        }

        .game-plays-header {
            color: #ffd700;
            font-size: 12px;
            font-weight: 600;
        }

        .wheel-status {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 16px;
            font-weight: 700;
            color: #333;
            text-align: center;
            pointer-events: none;
        }

        .game-back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .game-back-btn:active {
            background: rgba(255, 255, 255, 0.3);
        }

        .game-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Spin Wheel Overhaul */
        .wheel-container {
            position: relative;
            margin: 20px auto;
            width: 280px;
            height: 280px;
            /* Container for wheel + pointer + status */
        }

        .wheel-pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 35px solid #ff4757;
            filter: drop-shadow(0 4px 4px rgba(0, 0, 0, 0.4));
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid white;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            transition: transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            background: conic-gradient(#FF6B6B 0deg 60deg,
                    #4ECDC4 60deg 120deg,
                    #45B7D1 120deg 180deg,
                    #FFA07A 180deg 240deg,
                    #98D8C8 240deg 300deg,
                    #FFD93D 300deg 360deg);
            position: relative;
            overflow: hidden;
        }

        /* Wheel Labels */
        .wheel-label {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 50%;
            height: 20px;
            margin-top: -10px;
            transform-origin: 0% 50%;
            text-align: right;
            padding-right: 25px;
            color: white;
            font-weight: 800;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            white-space: nowrap;
        }

        /* Rotation for labels (East based) to match Segments (Top based) */
        /* Seg 0 (0-60, center 30). East (90) - 60 = 30. */
        .label-0 {
            transform: rotate(-60deg);
        }

        .label-1 {
            transform: rotate(0deg);
        }

        .label-2 {
            transform: rotate(60deg);
        }

        .label-3 {
            transform: rotate(120deg);
        }

        .label-4 {
            transform: rotate(180deg);
        }

        .label-5 {
            transform: rotate(240deg);
        }

        /* Seg 5 (300-360, center 330). 90+240=330. */

        /* Highlight Overlay - Fixed at Top (Winning Position) */
        /* Since rotation brings winner to TOP, we just highlight TOP wedge. */
        .wheel-highlight {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 15;
            background: conic-gradient(rgba(255, 255, 255, 0.5) 0deg 30deg,
                    transparent 30deg 330deg,
                    rgba(255, 255, 255, 0.5) 330deg 360deg);
            opacity: 0;
            transition: opacity 0.5s;
            border-radius: 50%;
            mix-blend-mode: overlay;
        }

        .wheel-highlight.show {
            opacity: 1;
        }

        .wheel.dim {
            filter: brightness(0.6);
        }

        .action-btn {
            margin-top: 20px;
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            min-width: 150px;
        }

        .action-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .action-btn.claimed {
            background: #10b981;
        }

        /* Tap Game */
        .tap-area {
            width: 180px;
            height: 180px;
            margin: 15px auto;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: white;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s;
        }

        .tap-area:active {
            transform: scale(0.9);
        }

        .tap-count {
            font-size: 50px;
            font-weight: bold;
            color: #667eea;
        }

        .timer {
            font-size: 24px;
            color: #666;
            margin: 10px 0;
        }

        /* Guess Game */
        .guess-input {
            width: 100%;
            padding: 15px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 12px;
            margin: 10px 0;
        }

        .attempts {
            color: #666;
            margin: 10px 0;
        }

        /* Reaction Game */
        .reaction-box {
            width: 180px;
            height: 180px;
            margin: 15px auto;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
        }

        .reaction-box.waiting {
            background: #ff6b6b;
            color: white;
        }

        .reaction-box.ready {
            background: #2ecc71;
            color: white;
        }

        .reaction-time {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
        }

        /* Quiz Game */
        .quiz-question {
            font-size: 18px;
            margin-bottom: 15px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
        }

        .quiz-option.correct {
            background: #2ecc71;
            color: white;
        }

        .quiz-option.wrong {
            background: #ff6b6b;
            color: white;
        }

        /* Catch Button */
        .catch-area {
            width: 100%;
            height: 250px;
            background: #f0f0f0;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .catch-target {
            position: absolute;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
        }

        /* Result - LARGE, CLEAR, HIGH CONTRAST */
        .result {
            font-size: 20px;
            margin: 15px 0;
            min-height: 30px;
        }

        .result.win {
            color: #2ecc71;
        }

        .result.lose {
            color: #ff6b6b;
        }

        .result.processing {
            color: #667eea;
        }

        /* GAME RESULT BOX - Large, Clear, Fixed */
        .game-result-box {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .result-score {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 8px;
        }

        .result-requirement {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 15px;
        }

        .result-reward {
            font-size: 36px;
            font-weight: 800;
            margin: 15px 0;
        }

        .result-reward.win {
            color: #2ecc71;
            text-shadow: 0 0 20px rgba(46, 204, 113, 0.5);
        }

        .result-reward.lose {
            color: #ff6b6b;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
        }

        .result-emoji {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .result-message {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 10px;
        }

        /* SPIN RESULT OVERLAY - Clear visibility */
        .spin-result-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            animation: fadeIn 0.3s ease;
        }

        .spin-result-overlay.show {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .spin-result-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            max-width: 90%;
            animation: scaleIn 0.4s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.5);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .spin-result-emoji {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 0.6s ease;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .spin-result-title {
            font-size: 28px;
            color: white;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .spin-result-coins {
            font-size: 48px;
            color: #ffd700;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 15px;
        }

        .spin-result-status {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.9);
            min-height: 30px;
        }

        .spin-result-success {
            color: #2ecc71;
            font-weight: 600;
        }

        .spin-result-close {
            margin-top: 25px;
            padding: 15px 40px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
        }

        /* POST-GAME FLOW */
        .post-game-actions {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            text-align: center;
        }

        .post-game-actions.show {
            display: block;
        }

        .reward-claimed-text {
            color: #2ecc71;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .back-to-hub-btn {
            padding: 14px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            display: none;
            z-index: 2000;
            max-width: 90%;
            text-align: center;
        }

        .toast.show {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                bottom: 60px;
                opacity: 0;
            }

            to {
                bottom: 80px;
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <button class="back-btn" onclick="goBack()">‚Üê Back</button>

    <div class="container" id="hub">
        <div class="header">
            <h1>üéÆ Play to Win</h1>
            <p>Fun games, real coins!</p>
        </div>
        <div class="daily-limit">
            Today's earnings: <span id="gameEarnings">0</span> coins
            <!-- <span id="limitWarning" style="display:none;color:#ffeb3b;margin-left:10px;">‚úì Limit reached</span> -->
        </div>
        <div class="games-grid" id="gamesGrid"></div>
    </div>

    <!-- SPIN RESULT OVERLAY -->
    <div class="spin-result-overlay" id="spinResultOverlay">
        <div class="spin-result-box">
            <div class="spin-result-emoji" id="spinResultEmoji">üéØ</div>
            <div class="spin-result-title">You Won!</div>
            <div class="spin-result-coins" id="spinResultCoins">0 coins</div>
            <div class="spin-result-status" id="spinResultStatus">Processing reward...</div>
            <button class="spin-result-close" id="spinResultClose" onclick="closeSpinResult()"
                style="display:none;">Continue</button>
        </div>
    </div>

    <!-- SPIN GAME MODAL -->
    <div class="game-modal" id="spinModal">
        <div class="game-modal-inner">
            <div class="game-header">
                <button class="game-back-btn" onclick="closeGame('spinModal')">‚Üê Back to Games</button>
                <span class="game-plays-header" id="spinPlaysHeader">2 plays left</span>
            </div>
            <div class="game-content">
                <h2>üé° Spin & Win</h2>
                <p style="margin:10px 0;color:#666;">Spin to win 5-50 coins!</p>
                <div class="wheel-container">
                    <div class="wheel-pointer"></div>
                    <div class="wheel-highlight" id="spinHighlight"></div>
                    <div class="wheel" id="spinWheel">
                        <div class="wheel-label label-0">5 Coins</div>
                        <div class="wheel-label label-1">10 Coins</div>
                        <div class="wheel-label label-2">20 Coins</div>
                        <div class="wheel-label label-3">5 Coins</div>
                        <div class="wheel-label label-4">10 Coins</div>
                        <div class="wheel-label label-5">50 Coins</div>
                    </div>
                    <div class="wheel-status" id="wheelStatus"></div>
                </div>
                <div id="spinResult" class="result"></div>
                <button class="action-btn" id="spinBtn" onclick="spinWheel()">SPIN</button>

                <!-- Post-game actions -->
                <div class="post-game-actions" id="spinPostGame">
                    <div class="reward-claimed-text">‚úì Reward claimed</div>
                    <button class="back-to-hub-btn" onclick="closeGame('spinModal')">Back to Play to Win</button>
                </div>
            </div>
        </div>
    </div>

    <!-- TAP GAME MODAL -->
    <div class="game-modal" id="tapModal">
        <div class="game-modal-inner">
            <div class="game-header">
                <button class="game-back-btn" onclick="closeGame('tapModal')">‚Üê Back to Games</button>
                <span class="game-plays-header" id="tapPlaysHeader">3 plays left</span>
            </div>
            <div class="game-content">
                <h2>üëÜ Tap Challenge</h2>
                <p style="margin:10px 0;color:#666;">Tap as fast as you can!</p>
                <div class="timer" id="tapTimer">10s</div>
                <div class="tap-count" id="tapCount">0</div>
                <div class="tap-area" id="tapArea" onclick="tapGame()">üëÜ</div>
                <div id="tapResult" class="result"></div>
                <button class="action-btn" id="tapStartBtn" onclick="startTapGame()">START</button>

                <!-- Post-game actions -->
                <div class="post-game-actions" id="tapPostGame">
                    <div class="reward-claimed-text">‚úì Reward claimed</div>
                    <button class="back-to-hub-btn" onclick="closeGame('tapModal')">Back to Play to Win</button>
                </div>
            </div>
        </div>
    </div>

    <!-- GUESS GAME MODAL -->
    <div class="game-modal" id="guessModal">
        <div class="game-modal-inner">
            <div class="game-header">
                <button class="game-back-btn" onclick="closeGame('guessModal')">‚Üê Back to Games</button>
                <span class="game-plays-header" id="guessPlaysHeader">2 plays left</span>
            </div>
            <div class="game-content">
                <h2>üî¢ Guess the Number</h2>
                <p style="margin:10px 0;color:#666;">Guess 1-10, 3 attempts!</p>
                <div class="attempts" id="guessAttempts">3 attempts left</div>
                <input type="number" class="guess-input" id="guessInput" min="1" max="10" placeholder="1-10">
                <div id="guessHint" style="margin:10px 0;color:#666;font-size:18px;"></div>
                <div id="guessResult" class="result"></div>
                <button class="action-btn" id="guessBtn" onclick="submitGuess()">GUESS</button>

                <!-- Post-game actions -->
                <div class="post-game-actions" id="guessPostGame">
                    <div class="reward-claimed-text">‚úì Reward claimed</div>
                    <button class="back-to-hub-btn" onclick="closeGame('guessModal')">Back to Play to Win</button>
                </div>
            </div>
        </div>
    </div>

    <!-- REACTION GAME MODAL -->
    <div class="game-modal" id="reactionModal">
        <div class="game-modal-inner">
            <div class="game-header">
                <button class="game-back-btn" onclick="closeGame('reactionModal')">‚Üê Back to Games</button>
                <span class="game-plays-header" id="reactionPlaysHeader">2 plays left</span>
            </div>
            <div class="game-content">
                <h2>‚ö° Reaction Game</h2>
                <p style="margin:10px 0;color:#666;">Wait for green, tap fast!</p>
                <div class="reaction-box waiting" id="reactionBox" onclick="reactionTap()">WAIT...</div>
                <div class="reaction-time" id="reactionTime"></div>
                <div id="reactionResult" class="result"></div>
                <button class="action-btn" id="reactionBtn" onclick="startReaction()">START</button>

                <!-- Post-game actions -->
                <div class="post-game-actions" id="reactionPostGame">
                    <div class="reward-claimed-text">‚úì Reward claimed</div>
                    <button class="back-to-hub-btn" onclick="closeGame('reactionModal')">Back to Play to Win</button>
                </div>
            </div>
        </div>
    </div>

    <!-- QUIZ GAME MODAL -->
    <div class="game-modal" id="quizModal">
        <div class="game-modal-inner">
            <div class="game-header">
                <button class="game-back-btn" onclick="closeGame('quizModal')">‚Üê Back to Games</button>
                <span class="game-plays-header" id="quizPlaysHeader">5 plays left (Today)</span>
            </div>
            <div class="game-content">
                <h2>‚ùì Quiz Game</h2>
                <p style="margin:10px 0;color:#666;">5 coins per correct answer!</p>
                <div id="quizScore" style="font-size:20px;margin:10px 0;">Score: 0</div>
                <div class="quiz-question" id="quizQuestion">Loading...</div>
                <div class="quiz-options" id="quizOptions"></div>
                <div id="quizResult" class="result"></div>

                <!-- Post-game actions -->
                <div class="post-game-actions" id="quizPostGame">
                    <div class="reward-claimed-text">‚úì Reward claimed</div>
                    <button class="back-to-hub-btn" onclick="closeGame('quizModal')">Back to Play to Win</button>
                </div>
            </div>
        </div>
        <div class="game-mini-ad" id="quizMiniAd">
            <button class="mini-ad-close" id="quizMiniAdClose" onclick="closeMiniAd('quizMiniAd')">‚úï</button>
            <div class="mini-ad-content">üì± Ad Space - Revenue Partner</div>
        </div>
    </div>

    <!-- CATCH GAME MODAL -->
    <div class="game-modal" id="catchModal">
        <div class="game-modal-inner">
            <div class="game-header">
                <button class="game-back-btn" onclick="closeGame('catchModal')">‚Üê Back to Games</button>
                <span class="game-plays-header" id="catchPlaysHeader">2 plays left</span>
            </div>
            <div class="game-content">
                <h2>üéØ Catch the Button</h2>
                <p style="margin:10px 0;color:#666;">Catch the moving target!</p>
                <div class="timer" id="catchTimer">10s</div>
                <div id="catchScore">Caught: 0</div>
                <div class="catch-area" id="catchArea">
                    <div class="catch-target" id="catchTarget" onclick="catchClick()">üéØ</div>
                </div>
                <div id="catchResult" class="result"></div>
                <button class="action-btn" id="catchBtn" onclick="startCatch()">START</button>

                <!-- Post-game actions -->
                <div class="post-game-actions" id="catchPostGame">
                    <div class="reward-claimed-text">‚úì Reward claimed</div>
                    <button class="back-to-hub-btn" onclick="closeGame('catchModal')">Back to Play to Win</button>
                </div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // Start games logic
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const BACKEND_URL = 'https://microearn-worker.abusaifeshovon.workers.dev';
        let gamesData = [];
        let todayEarnings = 0;
        let limitReached = false;

        let spin50Locked = false; // Track weekly 50 coin lock
        let isSubmitting = false; // Anti-abuse: prevent double submissions

        // ========== AD CLOSE BUTTON DELAYED VISIBILITY ==========
        // Show global ad close button after 3 seconds
        setTimeout(() => {
            const adClose = document.querySelector('.ad-close');
            if (adClose) adClose.classList.add('visible');
        }, 3000);

        // Check if ad was closed in this session
        if (sessionStorage.getItem('adClosed')) {
            document.getElementById('stickyAd')?.classList.add('hidden');
        }

        function closeAd() {
            document.getElementById('stickyAd').classList.add('hidden');
            sessionStorage.setItem('adClosed', 'true');
        }

        function closeMiniAd(adId) {
            document.getElementById(adId)?.classList.add('hidden');
        }

        function showMiniAdClose(gameId) {
            // Show mini-ad close button after 5 seconds (delayed)
            setTimeout(() => {
                const closeBtn = document.getElementById(gameId + 'MiniAdClose');
                if (closeBtn) closeBtn.classList.add('visible');
            }, 5000);
        }

        async function loadGamesStatus() {
            try {
                const response = await fetch(`${BACKEND_URL}/api/games/status`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ initData: tg.initData })
                });
                const data = await response.json();
                if (data.success) {
                    gamesData = data.games;
                    todayEarnings = data.today_earnings || 0;
                    limitReached = data.limit_reached || false;
                    spin50Locked = data.spin_50_locked || false; // Update lock status
                    renderGames();
                } else {
                    showToast('‚ùå ' + (data.error || 'Failed to load'));
                }
            } catch (error) {
                console.error('Load error:', error);
                showToast('‚ùå Network error');
            }
        }

        function renderGames() {
            document.getElementById('gameEarnings').textContent = todayEarnings;
            document.getElementById('gameEarnings').textContent = todayEarnings;
            // document.getElementById('limitWarning').style.display = limitReached ? 'inline' : 'none';

            const gamesConfig = [
                { id: 'spin', icon: 'üé°', name: 'Spin & Win', reward: '5-50', maxPlays: 2 },
                { id: 'tap', icon: 'üëÜ', name: 'Tap Challenge', reward: '10-20', maxPlays: 3 },
                { id: 'quiz', icon: '‚ùì', name: 'Quiz Game', reward: '5/ans', maxPlays: 5 },
                { id: 'guess', icon: 'üî¢', name: 'Guess Number', reward: '20', maxPlays: 2 },
                { id: 'reaction', icon: '‚ö°', name: 'Reaction', reward: '10-20', maxPlays: 2 },
                { id: 'catch', icon: 'üéØ', name: 'Catch Button', reward: '10-20', maxPlays: 2 }
            ];

            const grid = document.getElementById('gamesGrid');
            grid.innerHTML = gamesConfig.map(game => {
                const gameData = gamesData.find(g => g.id === game.id) || { plays: 0 };
                const remainingPlays = game.maxPlays - (gameData.plays || 0);
                const disabled = limitReached || remainingPlays <= 0;
                const exhausted = remainingPlays <= 0;
                return `
                    <div class="game-card ${disabled ? 'disabled' : ''}" onclick="${disabled ? '' : `openGame('${game.id}')`}">
                        <div class="game-icon">${game.icon}</div>
                        <div class="game-title">${game.name}</div>
                        <div class="game-reward">+${game.reward}</div>
                        <div class="game-plays ${exhausted ? 'exhausted' : ''}">${exhausted ? 'Come back tomorrow' : remainingPlays + '/' + game.maxPlays + ' plays left'}</div>
                    </div>
                `;
            }).join('');
        }

        function updatePlaysHeader(gameId) {
            const gamesConfig = {
                spin: { maxPlays: 2, header: 'spinPlaysHeader' },
                tap: { maxPlays: 3, header: 'tapPlaysHeader' },
                guess: { maxPlays: 2, header: 'guessPlaysHeader' },
                reaction: { maxPlays: 2, header: 'reactionPlaysHeader' },
                quiz: { maxPlays: 99, header: 'quizPlaysHeader' },
                catch: { maxPlays: 2, header: 'catchPlaysHeader' }
            };
            const config = gamesConfig[gameId];
            if (!config) return;

            const gameData = gamesData.find(g => g.id === gameId) || { plays: 0 };
            const remaining = config.maxPlays - (gameData.plays || 0);
            const header = document.getElementById(config.header);
            if (header) {
                header.textContent = remaining <= 0 ? 'No plays left' : remaining + ' plays left';
                header.style.color = remaining <= 0 ? '#ff6b6b' : '#ffd700';
            }
        }

        function openGame(gameId) {
            document.getElementById(gameId + 'Modal').classList.add('show');
            updatePlaysHeader(gameId);
            showMiniAdClose(gameId);
            // Reset game state when opening
            if (gameId === 'quiz') startQuiz();
            if (gameId === 'guess') resetGuessGame();
            if (gameId === 'spin') resetSpinGame();
            if (gameId === 'tap') resetTapGame();
            if (gameId === 'reaction') resetReactionGame();
            if (gameId === 'catch') resetCatchGame();
        }

        function closeGame(modalId) {
            document.getElementById(modalId).classList.remove('show');
            loadGamesStatus(); // Refresh status when closing
        }

        // Improved reward submission with anti-abuse
        async function submitReward(gameType, score, reward, btnId) {
            if (isSubmitting) {
                showToast('‚è≥ Processing...');
                return 0;
            }

            isSubmitting = true;
            const btn = btnId ? document.getElementById(btnId) : null;

            if (btn) {
                btn.disabled = true;
                btn.textContent = '‚è≥ Processing...';
            }

            try {
                console.log('Submitting reward:', { gameType, score, reward });

                const response = await fetch(`${BACKEND_URL}/api/games/reward`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        initData: tg.initData,
                        game_type: gameType,
                        score: score,
                        reward: reward
                    })
                });

                const data = await response.json();
                console.log('Reward response:', data);

                if (data.success) {
                    showToast(`‚úÖ +${data.reward} coins added!`);
                    todayEarnings = data.today_game_earnings || todayEarnings + data.reward;
                    document.getElementById('gameEarnings').textContent = todayEarnings;

                    // CRITICAL: Refresh game data to update play counts
                    await loadGamesStatus();

                    if (btn) {
                        btn.textContent = '‚úì Claimed';
                        btn.classList.add('claimed');
                    }
                    return data.reward;
                } else {
                    // Show specific error
                    const errorMsg = data.error || 'Failed to claim reward';
                    showToast(`‚ùå ${errorMsg}`);

                    if (btn) {
                        btn.disabled = false;
                        btn.textContent = 'TRY AGAIN';
                    }
                    return 0;
                }
            } catch (error) {
                console.error('Reward error:', error);
                showToast('‚ùå Network error - check connection');

                if (btn) {
                    btn.disabled = false;
                    btn.textContent = 'TRY AGAIN';
                }
                return 0;
            } finally {
                isSubmitting = false;
            }
        }

        // === SPIN GAME ===
        let spinning = false;
        let spinSessionClaimed = false; // Prevent duplicate submissions
        const spinRewards = [5, 10, 20, 5, 10, 50];

        function resetSpinGame() {
            spinning = false;
            spinSessionClaimed = false;
            document.getElementById('spinWheel').style.transform = 'rotate(0deg)';
            document.getElementById('spinResult').textContent = '';
            document.getElementById('wheelStatus').textContent = '';
            document.getElementById('spinBtn').disabled = false;
            document.getElementById('spinBtn').textContent = 'SPIN';
            document.getElementById('spinBtn').classList.remove('claimed');
            document.getElementById('spinPostGame').classList.remove('show');

            // Reset visuals
            document.getElementById('spinHighlight').classList.remove('show');
            document.getElementById('spinWheel').classList.remove('dim');

            // Apply Lock Visuals
            const label50 = document.querySelector('.label-5');
            if (spin50Locked) {
                label50.style.opacity = '0.3';
                label50.innerHTML = 'üîí 50';
            } else {
                label50.style.opacity = '1';
                label50.innerHTML = '50 Coins';
            }
            document.getElementById('spinResultOverlay').classList.remove('show');
        }

        function showSpinResultOverlay(coins, status, showClose = false) {
            document.getElementById('spinResultCoins').textContent = `${coins} coins`;
            document.getElementById('spinResultStatus').textContent = status;
            document.getElementById('spinResultStatus').className = showClose ? 'spin-result-status spin-result-success' : 'spin-result-status';
            document.getElementById('spinResultClose').style.display = showClose ? 'block' : 'none';
            document.getElementById('spinResultOverlay').classList.add('show');
        }

        function closeSpinResult() {
            document.getElementById('spinResultOverlay').classList.remove('show');
        }

        async function spinWheel() {
            if (spinning || spinSessionClaimed) return;
            spinning = true;
            const btn = document.getElementById('spinBtn');
            btn.disabled = true;
            btn.textContent = 'Spinning...';
            document.getElementById('spinResult').textContent = '';

            // Show SPINNING text in wheel center
            document.getElementById('wheelStatus').textContent = 'üé∞ Spinning...';

            const wheel = document.getElementById('spinWheel');
            const resultIndex = Math.floor(Math.random() * 6);
            /* 
               Rotation Math:
               5 full spins (1800deg) + alignment.
               Target: 360 - Center(Index).
               Center = Index * 60 + 30.
            */
            const deg = 360 * 5 + (360 - (resultIndex * 60 + 30));
            wheel.style.transform = `rotate(${deg}deg)`;

            setTimeout(async () => {
                const reward = spinRewards[resultIndex];

                // Highlight Winner & Dim rest
                document.getElementById('spinHighlight').classList.add('show');
                document.getElementById('spinWheel').classList.add('dim');
                document.getElementById('wheelStatus').textContent = `üéØ ${reward} coins!`;

                // Show Processing Result Box
                const resultDiv = document.getElementById('spinResult');
                resultDiv.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üéâ</div>
                        <div class="result-score">Wheel Result</div>
                        <div class="result-reward processing">Verifying...</div>
                    </div>
                `;

                // Process reward
                const earned = await submitReward('spin', resultIndex, reward, 'spinBtn');

                if (earned > 0) {
                    spinSessionClaimed = true;
                    // Update Text Status
                    document.getElementById('wheelStatus').textContent = `‚úì +${earned} Coins!`;

                    // Update Result Box
                    resultDiv.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üéâ</div>
                            <div class="result-score">You Won: ${reward} Coins</div>
                            <div class="result-reward win">‚úì +${earned} Added!</div>
                        </div>
                    `;

                    // Show Overlay for extra pop
                    showSpinResultOverlay(earned, `‚úì +${earned} coins added!`, true);

                    // Show post-game actions
                    document.getElementById('spinPostGame').classList.add('show');
                    btn.textContent = '‚úì Claimed';
                } else {
                    document.getElementById('wheelStatus').textContent = '‚ùå Failed';
                    resultDiv.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">‚ùå</div>
                            <div class="result-score">Reward Failed</div>
                            <div class="result-reward lose">Could not add coins</div>
                        </div>
                    `;
                    showSpinResultOverlay(reward, '‚ùå Processing Failed', true);
                    btn.disabled = false;
                    btn.textContent = 'TRY AGAIN';
                }
                spinning = false;
            }, 5500);
        }

        // === TAP GAME ===
        let tapCount = 0, tapGameActive = false, tapInterval;

        function resetTapGame() {
            tapCount = 0;
            tapGameActive = false;
            clearInterval(tapInterval);
            document.getElementById('tapCount').textContent = '0';
            document.getElementById('tapTimer').textContent = '10s';
            document.getElementById('tapResult').textContent = '';
            document.getElementById('tapStartBtn').disabled = false;
            document.getElementById('tapStartBtn').textContent = 'START';
            document.getElementById('tapStartBtn').classList.remove('claimed');
            document.getElementById('tapPostGame').classList.remove('show');
        }

        function startTapGame() {
            tapCount = 0;
            tapGameActive = true;
            document.getElementById('tapCount').textContent = '0';
            document.getElementById('tapResult').textContent = '';
            document.getElementById('tapStartBtn').disabled = true;
            document.getElementById('tapStartBtn').textContent = 'Tapping...';
            let timeLeft = 10;
            document.getElementById('tapTimer').textContent = timeLeft + 's';

            tapInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('tapTimer').textContent = timeLeft + 's';
                if (timeLeft <= 0) {
                    clearInterval(tapInterval);
                    endTapGame();
                }
            }, 1000);
        }

        function tapGame() {
            if (!tapGameActive) return;
            tapCount++;
            document.getElementById('tapCount').textContent = tapCount;
        }

        async function endTapGame() {
            tapGameActive = false;
            let reward = 0;
            let requirement = '30+ taps';
            if (tapCount >= 81) { reward = 20; requirement = '81+ taps (MAX)'; }
            else if (tapCount >= 51) { reward = 15; requirement = '51+ taps'; }
            else if (tapCount >= 30) { reward = 10; requirement = '30+ taps'; }

            // Show detailed result with score breakdown
            const resultEl = document.getElementById('tapResult');

            if (reward > 0) {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üëÜ</div>
                        <div class="result-score">Your Score: ${tapCount} taps</div>
                        <div class="result-requirement">Requirement: ${requirement}</div>
                        <div class="result-reward win">üéâ +${reward} Coins</div>
                        <div class="result-message">‚è≥ Processing reward...</div>
                    </div>
                `;

                const earned = await submitReward('tap', tapCount, reward, 'tapStartBtn');

                if (earned > 0) {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üéâ</div>
                            <div class="result-score">Your Score: ${tapCount} taps</div>
                            <div class="result-requirement">Requirement: ${requirement}</div>
                            <div class="result-reward win">‚úì +${earned} Coins Added!</div>
                            <div class="result-message">Balance updated successfully</div>
                        </div>
                    `;
                    document.getElementById('tapPostGame').classList.add('show');
                } else {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">‚ùå</div>
                            <div class="result-score">Your Score: ${tapCount} taps</div>
                            <div class="result-reward lose">Reward could not be added</div>
                            <div class="result-message">Please try again</div>
                        </div>
                    `;
                }
            } else {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üòî</div>
                        <div class="result-score">Your Score: ${tapCount} taps</div>
                        <div class="result-requirement">Requirement: 30+ taps needed</div>
                        <div class="result-reward lose">Reward: 0 Coins</div>
                        <div class="result-message">Try faster next time!</div>
                    </div>
                `;
                document.getElementById('tapStartBtn').disabled = false;
                document.getElementById('tapStartBtn').textContent = 'TRY AGAIN';
            }
        }

        // === GUESS GAME ===
        let secretNumber = 0, guessAttempts = 0;

        function resetGuessGame() {
            secretNumber = Math.floor(Math.random() * 10) + 1;
            guessAttempts = 0;
            document.getElementById('guessAttempts').textContent = '3 attempts left';
            document.getElementById('guessHint').textContent = '';
            document.getElementById('guessResult').textContent = '';
            document.getElementById('guessInput').value = '';
            document.getElementById('guessBtn').disabled = false;
            document.getElementById('guessBtn').textContent = 'GUESS';
            document.getElementById('guessBtn').classList.remove('claimed');
            document.getElementById('guessPostGame').classList.remove('show');
        }

        async function submitGuess() {
            const guess = parseInt(document.getElementById('guessInput').value);
            if (isNaN(guess) || guess < 1 || guess > 10) {
                showToast('Enter a number 1-10');
                return;
            }

            guessAttempts++;
            const remaining = 3 - guessAttempts;
            document.getElementById('guessAttempts').textContent = remaining + ' attempts left';

            const resultEl = document.getElementById('guessResult');

            if (guess === secretNumber) {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">ü§î</div>
                        <div class="result-score">Thinking...</div>
                        <div class="result-reward processing">Verifying...</div>
                    </div>
                `;

                const earned = await submitReward('guess', guessAttempts, 20, 'guessBtn');

                if (earned > 0) {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üéâ</div>
                            <div class="result-score">Correct Number: ${secretNumber}</div>
                            <div class="result-reward win">‚úì +${earned} Coins Added!</div>
                            <div class="result-message">Great guess!</div>
                        </div>
                    `;
                    document.getElementById('guessPostGame').classList.add('show');
                } else {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">‚ùå</div>
                            <div class="result-score">Correct Number: ${secretNumber}</div>
                            <div class="result-reward lose">Reward Failed</div>
                            <div class="result-message">Could not add coins</div>
                        </div>
                    `;
                }
            } else {
                document.getElementById('guessHint').textContent = guess < secretNumber ? 'üìà Higher!' : 'üìâ Lower!';
                if (remaining <= 0) {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üòî</div>
                            <div class="result-score">The number was: ${secretNumber}</div>
                            <div class="result-reward lose">Reward: 0 Coins</div>
                            <div class="result-message">Out of attempts!</div>
                        </div>
                    `;
                    document.getElementById('guessBtn').disabled = true;
                }
            }
            document.getElementById('guessInput').value = '';
        }

        // === REACTION GAME ===
        let reactionStartTime = 0, reactionWaiting = false, reactionTimeout;

        function resetReactionGame() {
            reactionStartTime = 0;
            reactionWaiting = false;
            clearTimeout(reactionTimeout);
            const box = document.getElementById('reactionBox');
            box.className = 'reaction-box waiting';
            box.textContent = 'WAIT...';
            document.getElementById('reactionTime').textContent = '';
            document.getElementById('reactionResult').textContent = '';
            document.getElementById('reactionBtn').disabled = false;
            document.getElementById('reactionBtn').textContent = 'START';
            document.getElementById('reactionBtn').classList.remove('claimed');
            document.getElementById('reactionPostGame').classList.remove('show');
        }

        function startReaction() {
            document.getElementById('reactionBtn').disabled = true;
            document.getElementById('reactionBtn').textContent = 'Wait...';
            document.getElementById('reactionTime').textContent = '';
            document.getElementById('reactionResult').textContent = '';
            const box = document.getElementById('reactionBox');
            box.className = 'reaction-box waiting';
            box.textContent = 'WAIT...';
            reactionWaiting = true;

            reactionTimeout = setTimeout(() => {
                box.className = 'reaction-box ready';
                box.textContent = 'TAP NOW!';
                reactionStartTime = Date.now();
                reactionWaiting = false;
            }, 2000 + Math.random() * 3000);
        }

        async function reactionTap() {
            if (reactionWaiting) {
                clearTimeout(reactionTimeout);
                document.getElementById('reactionResult').textContent = '‚ùå Too early!';
                document.getElementById('reactionResult').className = 'result lose';
                document.getElementById('reactionBtn').disabled = false;
                document.getElementById('reactionBtn').textContent = 'TRY AGAIN';
                const box = document.getElementById('reactionBox');
                box.className = 'reaction-box waiting';
                box.textContent = 'Too early';
                return;
            }

            if (reactionStartTime === 0) return;

            const reactionTime = Date.now() - reactionStartTime;
            reactionStartTime = 0;
            document.getElementById('reactionTime').textContent = reactionTime + 'ms';

            let reward = 0;
            let requirement = 'Need < 500ms';
            if (reactionTime < 300) { reward = 20; requirement = 'Lightning Fast! (<300ms)'; }
            else if (reactionTime < 500) { reward = 10; requirement = 'Fast Enough (<500ms)'; }

            const resultEl = document.getElementById('reactionResult');

            if (reward > 0) {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">‚ö°</div>
                        <div class="result-score">Time: ${reactionTime}ms</div>
                        <div class="result-requirement">Level: ${requirement}</div>
                        <div class="result-reward processing">Verifying...</div>
                    </div>
                `;

                const earned = await submitReward('reaction', reactionTime, reward, 'reactionBtn');

                if (earned > 0) {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üéâ</div>
                            <div class="result-score">Time: ${reactionTime}ms</div>
                            <div class="result-reward win">‚úì +${earned} Coins Added!</div>
                            <div class="result-message">Excellent speed!</div>
                        </div>
                    `;
                    document.getElementById('reactionPostGame').classList.add('show');
                } else {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">‚ùå</div>
                            <div class="result-score">Time: ${reactionTime}ms</div>
                            <div class="result-reward lose">Reward Failed</div>
                            <div class="result-message">Could not add coins</div>
                        </div>
                    `;
                    document.getElementById('reactionBtn').disabled = false;
                    document.getElementById('reactionBtn').textContent = 'TRY AGAIN';
                }
            } else {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üê¢</div>
                        <div class="result-score">Time: ${reactionTime}ms</div>
                        <div class="result-requirement">Needed < 500ms</div>
                        <div class="result-reward lose">Reward: 0 Coins</div>
                        <div class="result-message">Too slow! Try again.</div>
                    </div>
                `;
                document.getElementById('reactionBtn').disabled = false;
                document.getElementById('reactionBtn').textContent = 'TRY AGAIN';
            }
        }


        // === ADVANCED QUIZ GAME SYSTEM ===
        // 200+ Questions with Categories, Difficulties, and True Randomization

        const QUIZ_QUESTION_POOL = [
            // MATHEMATICS - Easy (20 questions)
            { id: 1, q: "What is 5 + 7?", options: ["10", "12", "13", "11"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 2, q: "What is 10 - 3?", options: ["6", "7", "8", "9"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 3, q: "What is 6 √ó 2?", options: ["10", "11", "12", "13"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 4, q: "What is 15 √∑ 3?", options: ["4", "5", "6", "7"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 5, q: "What is 8 + 8?", options: ["14", "15", "16", "17"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 6, q: "What is 20 - 5?", options: ["13", "14", "15", "16"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 7, q: "What is 3 √ó 4?", options: ["10", "11", "12", "13"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 8, q: "What is 25 √∑ 5?", options: ["4", "5", "6", "7"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 9, q: "What is 9 + 6?", options: ["14", "15", "16", "17"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 10, q: "What is 18 - 9?", options: ["7", "8", "9", "10"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 11, q: "What is 7 √ó 3?", options: ["19", "20", "21", "22"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 12, q: "What is 30 √∑ 6?", options: ["4", "5", "6", "7"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 13, q: "What is 11 + 9?", options: ["18", "19", "20", "21"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 14, q: "What is 50 - 25?", options: ["23", "24", "25", "26"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 15, q: "What is 5 √ó 5?", options: ["20", "25", "30", "35"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 16, q: "What is 40 √∑ 8?", options: ["4", "5", "6", "7"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 17, q: "What is 13 + 7?", options: ["18", "19", "20", "21"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 18, q: "What is 100 - 50?", options: ["40", "50", "60", "70"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },
            { id: 19, q: "What is 9 √ó 2?", options: ["16", "17", "18", "19"], correct: 2, category: "Math", difficulty: "Easy", points: 5 },
            { id: 20, q: "What is 36 √∑ 6?", options: ["5", "6", "7", "8"], correct: 1, category: "Math", difficulty: "Easy", points: 5 },

            // MATHEMATICS - Medium (20 questions)
            { id: 21, q: "What is 15% of 200?", options: ["25", "30", "35", "40"], correct: 1, category: "Math", difficulty: "Medium", points: 7 },
            { id: 22, q: "What is 12¬≤?", options: ["124", "134", "144", "154"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 23, q: "What is ‚àö64?", options: ["6", "7", "8", "9"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 24, q: "What is 25 √ó 25?", options: ["525", "575", "625", "675"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 25, q: "What is 144 √∑ 12?", options: ["11", "12", "13", "14"], correct: 1, category: "Math", difficulty: "Medium", points: 7 },
            { id: 26, q: "What is 20% of 500?", options: ["90", "95", "100", "105"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 27, q: "What is 8¬≥?", options: ["484", "504", "512", "524"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 28, q: "What is ‚àö100?", options: ["8", "9", "10", "11"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 29, q: "What is 33 √ó 3?", options: ["89", "93", "99", "103"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 30, q: "What is 225 √∑ 15?", options: ["13", "14", "15", "16"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 31, q: "What is 50% of 88?", options: ["42", "43", "44", "45"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 32, q: "What is 15¬≤?", options: ["215", "225", "235", "245"], correct: 1, category: "Math", difficulty: "Medium", points: 7 },
            { id: 33, q: "What is ‚àö169?", options: ["11", "12", "13", "14"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 34, q: "What is 45 √ó 4?", options: ["170", "175", "180", "185"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 35, q: "What is 288 √∑ 12?", options: ["22", "23", "24", "25"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 36, q: "What is 75% of 120?", options: ["85", "90", "95", "100"], correct: 1, category: "Math", difficulty: "Medium", points: 7 },
            { id: 37, q: "What is 11¬≤?", options: ["111", "121", "131", "141"], correct: 1, category: "Math", difficulty: "Medium", points: 7 },
            { id: 38, q: "What is ‚àö196?", options: ["12", "13", "14", "15"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 39, q: "What is 17 √ó 6?", options: ["96", "100", "102", "106"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },
            { id: 40, q: "What is 420 √∑ 21?", options: ["18", "19", "20", "21"], correct: 2, category: "Math", difficulty: "Medium", points: 7 },

            // GENERAL KNOWLEDGE - Easy (20 questions)
            { id: 41, q: "Capital of France?", options: ["London", "Berlin", "Paris", "Rome"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 42, q: "Largest planet?", options: ["Earth", "Mars", "Jupiter", "Saturn"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 43, q: "H2O is?", options: ["Salt", "Sugar", "Water", "Oil"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 44, q: "Days in a week?", options: ["5", "6", "7", "8"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 45, q: "Months in a year?", options: ["10", "11", "12", "13"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 46, q: "Continents on Earth?", options: ["5", "6", "7", "8"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 47, q: "Color of sky?", options: ["Green", "Blue", "Red", "Yellow"], correct: 1, category: "GK", difficulty: "Easy", points: 5 },
            { id: 48, q: "Capital of USA?", options: ["New York", "Washington DC", "LA", "Chicago"], correct: 1, category: "GK", difficulty: "Easy", points: 5 },
            { id: 49, q: "Seasons in a year?", options: ["2", "3", "4", "5"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 50, q: "Largest ocean?", options: ["Atlantic", "Indian", "Pacific", "Arctic"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 51, q: "Sun rises from?", options: ["West", "East", "North", "South"], correct: 1, category: "GK", difficulty: "Easy", points: 5 },
            { id: 52, q: "Fastest land animal?", options: ["Lion", "Tiger", "Cheetah", "Leopard"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 53, q: "Hours in a day?", options: ["20", "22", "24", "26"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 54, q: "Colors in rainbow?", options: ["5", "6", "7", "8"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 55, q: "Capital of Japan?", options: ["Seoul", "Tokyo", "Beijing", "Bangkok"], correct: 1, category: "GK", difficulty: "Easy", points: 5 },
            { id: 56, q: "Smallest continent?", options: ["Europe", "Antarctica", "Australia", "Africa"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 57, q: "Coldest place?", options: ["Alaska", "Siberia", "Antarctica", "Greenland"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 58, q: "Tallest mountain?", options: ["K2", "Kilimanjaro", "Everest", "Denali"], correct: 2, category: "GK", difficulty: "Easy", points: 5 },
            { id: 59, q: "Largest desert?", options: ["Sahara", "Gobi", "Arabian", "Kalahari"], correct: 0, category: "GK", difficulty: "Easy", points: 5 },
            { id: 60, q: "National bird of USA?", options: ["Eagle", "Hawk", "Falcon", "Owl"], correct: 0, category: "GK", difficulty: "Easy", points: 5 },

            // GENERAL KNOWLEDGE - Medium (20 questions)
            { id: 61, q: "Who painted Mona Lisa?", options: ["Picasso", "Da Vinci", "Van Gogh", "Michelangelo"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 62, q: "Speed of light (km/s)?", options: ["250,000", "300,000", "350,000", "400,000"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 63, q: "Chemical symbol for Gold?", options: ["Go", "Gd", "Au", "Ag"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 64, q: "Year WW2 ended?", options: ["1943", "1944", "1945", "1946"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 65, q: "Inventor of telephone?", options: ["Edison", "Bell", "Tesla", "Marconi"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 66, q: "Capital of Australia?", options: ["Sydney", "Melbourne", "Canberra", "Perth"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 67, q: "Longest river?", options: ["Amazon", "Nile", "Yangtze", "Mississippi"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 68, q: "Human bones count?", options: ["196", "206", "216", "226"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 69, q: "Deepest ocean trench?", options: ["Tonga", "Java", "Mariana", "Puerto Rico"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 70, q: "Smallest country?", options: ["Monaco", "Vatican", "Malta", "Liechtenstein"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 71, q: "Who wrote Romeo & Juliet?", options: ["Chaucer", "Milton", "Dickens", "Shakespeare"], correct: 3, category: "GK", difficulty: "Medium", points: 7 },
            { id: 72, q: "Boiling point of water (¬∞C)?", options: ["90", "95", "100", "105"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 73, q: "Planet closest to Sun?", options: ["Venus", "Earth", "Mercury", "Mars"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 74, q: "Inventor of bulb?", options: ["Tesla", "Edison", "Bell", "Franklin"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 75, q: "Capital of Canada?", options: ["Toronto", "Vancouver", "Ottawa", "Montreal"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 76, q: "Largest mammal?", options: ["Elephant", "Blue Whale", "Giraffe", "Rhino"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 77, q: "Chemical symbol for Silver?", options: ["Si", "Sv", "Ag", "Sr"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 78, q: "Year of moon landing?", options: ["1967", "1968", "1969", "1970"], correct: 2, category: "GK", difficulty: "Medium", points: 7 },
            { id: 79, q: "Hardest natural substance?", options: ["Steel", "Diamond", "Titanium", "Graphite"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },
            { id: 80, q: "Number of planets?", options: ["7", "8", "9", "10"], correct: 1, category: "GK", difficulty: "Medium", points: 7 },

            // LOGIC & REASONING - Easy (20 questions)
            { id: 81, q: "If 2+2=4, what is 3+3?", options: ["5", "6", "7", "8"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 82, q: "Next in series: 2,4,6,8,?", options: ["9", "10", "11", "12"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 83, q: "Opposite of Hot?", options: ["Warm", "Cool", "Cold", "Freeze"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 84, q: "Next letter: A,B,C,D,?", options: ["E", "F", "G", "H"], correct: 0, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 85, q: "Who am I? I have keys but no locks", options: ["Door", "Piano", "Lock", "Safe"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 86, q: "Complete: Day is to Night as Sun is to?", options: ["Star", "Moon", "Sky", "Cloud"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 87, q: "Next number: 10,20,30,40,?", options: ["45", "50", "55", "60"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 88, q: "Odd one out: Dog, Cat, Lion, Car", options: ["Dog", "Cat", "Lion", "Car"], correct: 3, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 89, q: "Complete: Fire is to Hot as Ice is to?", options: ["Water", "Snow", "Cold", "Frozen"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 90, q: "Next: 1,3,5,7,?", options: ["8", "9", "10", "11"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 91, q: "Opposite of Day?", options: ["Morning", "Evening", "Night", "Noon"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 92, q: "Series: 5,10,15,20,?", options: ["22", "24", "25", "27"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 93, q: "Complete: Pen is to Write as Brush is to?", options: ["Draw", "Paint", "Color", "Sketch"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 94, q: "Odd one out: Apple, Banana, Carrot, Mango", options: ["Apple", "Banana", "Carrot", "Mango"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 95, q: "Next letter: M,N,O,P,?", options: ["Q", "R", "S", "T"], correct: 0, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 96, q: "Complete: Happy is to Sad as Laugh is to?", options: ["Smile", "Cry", "Grin", "Giggle"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 97, q: "Series: 3,6,9,12,?", options: ["13", "14", "15", "16"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 98, q: "Opposite of Big?", options: ["Large", "Small", "Tiny", "Huge"], correct: 1, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 99, q: "Next: 100,90,80,70,?", options: ["50", "55", "60", "65"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },
            { id: 100, q: "Complete: Book is to Read as Music is to?", options: ["Hear", "Play", "Listen", "Sing"], correct: 2, category: "Logic", difficulty: "Easy", points: 5 },

            // LOGIC & REASONING - Medium (20 questions)
            { id: 101, q: "If A=1, B=2, C=3, what is CAB?", options: ["312", "321", "123", "213"], correct: 0, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 102, q: "Pattern: 2,6,12,20,? (n¬≤+n)", options: ["28", "30", "32", "34"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 103, q: "Analogy: Doctor:Hospital :: Teacher:?", options: ["Student", "Book", "School", "Class"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 104, q: "Sequence: 1,1,2,3,5,8,? (Fibonacci)", options: ["11", "12", "13", "14"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 105, q: "If all Flurps are Glurps, and some Glurps are Blurps, are all Flurps Blurps?", options: ["Yes", "No", "Maybe", "Cannot say"], correct: 3, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 106, q: "Pattern: 3,9,27,81,? (√ó3)", options: ["162", "243", "324", "405"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 107, q: "Word opposite in meaning: Generous", options: ["Kind", "Selfish", "Giving", "Helpful"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 108, q: "Next in pattern: AZ, BY, CX, DW, ?", options: ["EV", "EU", "FV", "FU"], correct: 0, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 109, q: "If 5 cats catch 5 rats in 5 min, how many for 100 rats?", options: ["20 cats", "50 cats", "5 cats", "100 cats"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 110, q: "Missing number: 4,9,16,25,? (squares)", options: ["30", "32", "34", "36"], correct: 3, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 111, q: "Analogy: Hand:Glove :: Foot:?", options: ["Boot", "Sock", "Shoe", "Sandal"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 112, q: "Series: 2,4,8,16,? (√ó2)", options: ["24", "28", "32", "36"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 113, q: "Complete: Lion:Pride :: Bee:?", options: ["Hive", "Swarm", "Colony", "Nest"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 114, q: "Pattern: 1,4,9,16,25,? (n¬≤)", options: ["30", "36", "42", "49"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 115, q: "If TRADE=86412, what is READ?", options: ["6214", "8142", "4261", "6124"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 116, q: "Missing: 100,81,64,49,? (descending squares)", options: ["40", "36", "32", "25"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 117, q: "Analogy: Painter:Brush :: Writer:?", options: ["Book", "Paper", "Pen", "Ink"], correct: 2, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 118, q: "Series: 7,14,21,28,? (√ó7)", options: ["32", "33", "34", "35"], correct: 3, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 119, q: "Next letter series: ACE, FHJ, KMO, ?", options: ["NPR", "PRT", "PRV", "NQS"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },
            { id: 120, q: "Pattern: 5,25,125,? (√ó5)", options: ["525", "625", "725", "825"], correct: 1, category: "Logic", difficulty: "Medium", points: 7 },

            // ENGLISH & VOCABULARY - Easy (20 questions)
            { id: 121, q: "Synonym of Happy?", options: ["Sad", "Joyful", "Angry", "Tired"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 122, q: "Antonym of Good?", options: ["Great", "Nice", "Bad", "Fine"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 123, q: "Plural of Child?", options: ["Childs", "Childes", "Children", "Childrens"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 124, q: "Past tense of Go?", options: ["Goed", "Gone", "Went", "Going"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 125, q: "A person who writes books?", options: ["Reader", "Author", "Publisher", "Editor"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 126, q: "Synonym of Big?", options: ["Small", "Large", "Tiny", "Little"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 127, q: "Antonym of Hot?", options: ["Warm", "Cool", "Cold", "Mild"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 128, q: "Plural of Mouse?", options: ["Mouses", "Mices", "Mice", "Meese"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 129, q: "Past tense of Eat?", options: ["Eated", "Eaten", "Ate", "Eating"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 130, q: "Opposite of Dark?", options: ["Dim", "Bright", "Light", "White"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 131, q: "Synonym of Fast?", options: ["Slow", "Quick", "Lazy", "Calm"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 132, q: "Plural of Foot?", options: ["Foots", "Feets", "Feet", "Footes"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 133, q: "Past tense of Run?", options: ["Runned", "Running", "Ran", "Run"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 134, q: "Antonym of Easy?", options: ["Simple", "Hard", "Soft", "Light"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 135, q: "Synonym of Smart?", options: ["Dumb", "Clever", "Foolish", "Stupid"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 136, q: "Plural of Tooth?", options: ["Tooths", "Teeth", "Toothes", "Teeths"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 137, q: "Past tense of See?", options: ["Seed", "Seen", "Saw", "Seeing"], correct: 2, category: "English", difficulty: "Easy", points: 5 },
            { id: 138, q: "Opposite of Old?", options: ["Ancient", "Young", "New", "Fresh"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 139, q: "Synonym of Begin?", options: ["End", "Start", "Stop", "Finish"], correct: 1, category: "English", difficulty: "Easy", points: 5 },
            { id: 140, q: "Plural of Man?", options: ["Mans", "Mens", "Men", "Manes"], correct: 2, category: "English", difficulty: "Easy", points: 5 },

            // TECHNOLOGY & SCIENCE - Easy (20 questions)
            { id: 141, q: "WWW stands for?", options: ["World Wide Web", "Web World Wide", "Wide World Web", "World Web Wide"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 142, q: "CPU stands for?", options: ["Computer Process Unit", "Central Processing Unit", "Central Process Unit", "Computer Processing Unit"], correct: 1, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 143, q: "RAM stands for?", options: ["Read Access Memory", "Random Access Memory", "Run Access Memory", "Real Access Memory"], correct: 1, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 144, q: "Planets orbit around?", options: ["Moon", "Earth", "Sun", "Stars"], correct: 2, category: "Science", difficulty: "Easy", points: 5 },
            { id: 145, q: "Water freezes at?", options: ["0¬∞C", "10¬∞C", "32¬∞C", "100¬∞C"], correct: 0, category: "Science", difficulty: "Easy", points: 5 },
            { id: 146, q: "Primary colors?", options: ["Red Blue Yellow", "Red Green Blue", "Yellow Green Blue", "Red Orange Yellow"], correct: 0, category: "Science", difficulty: "Easy", points: 5 },
            { id: 147, q: "Earth's satellite?", options: ["Sun", "Mars", "Moon", "Venus"], correct: 2, category: "Science", difficulty: "Easy", points: 5 },
            { id: 148, q: "USB stands for?", options: ["Universal Serial Bus", "United Serial Bus", "Universal System Bus", "United System Bus"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 149, q: "Lightning is a form of?", options: ["Water", "Electricity", "Fire", "Wind"], correct: 1, category: "Science", difficulty: "Easy", points: 5 },
            { id: 150, q: "HTML stands for?", options: ["Hypertext Markup Language", "Hyperlink Markup Language", "Hypertext Mark Language", "Hyperlink Mark Language"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 151, q: "Oxygen's chemical symbol?", options: ["Ox", "O", "O2", "Og"], correct: 1, category: "Science", difficulty: "Easy", points: 5 },
            { id: 152, q: "PDF stands for?", options: ["Portable Document Format", "Personal Document Format", "Portable Data Format", "Personal Data Format"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 153, q: "Largest organ in human body?", options: ["Brain", "Heart", "Liver", "Skin"], correct: 3, category: "Science", difficulty: "Easy", points: 5 },
            { id: 154, q: "GPS stands for?", options: ["Global Position System", "Global Positioning System", "General Position System", "General Positioning System"], correct: 1, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 155, q: "Plants produce oxygen through?", options: ["Respiration", "Digestion", "Photosynthesis", "Transpiration"], correct: 2, category: "Science", difficulty: "Easy", points: 5 },
            { id: 156, q: "URL stands for?", options: ["Uniform Resource Locator", "Universal Resource Locator", "Uniform Reference Locator", "Universal Reference Locator"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 157, q: "Sound travels fastest in?", options: ["Air", "Water", "Solid", "Vacuum"], correct: 2, category: "Science", difficulty: "Easy", points: 5 },
            { id: 158, q: "WiFi stands for?", options: ["Wireless Fidelity", "Wire Fidelity", "Wireless Field", "Wire Field"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },
            { id: 159, q: "Humans have how many senses?", options: ["4", "5", "6", "7"], correct: 1, category: "Science", difficulty: "Easy", points: 5 },
            { id: 160, q: "AI stands for?", options: ["Artificial Intelligence", "Actual Intelligence", "Artificial Information", "Actual Information"], correct: 0, category: "Tech", difficulty: "Easy", points: 5 },

            // MATHEMATICS - Hard (10 questions)
            { id: 161, q: "What is 17 √ó 23?", options: ["381", "391", "401", "411"], correct: 1, category: "Math", difficulty: "Hard", points: 10 },
            { id: 162, q: "What is 729 √∑ 27?", options: ["25", "26", "27", "28"], correct: 2, category: "Math", difficulty: "Hard", points: 10 },
            { id: 163, q: "What is 25% of 640?", options: ["150", "155", "160", "165"], correct: 2, category: "Math", difficulty: "Hard", points: 10 },
            { id: 164, q: "What is 13¬≥?", options: ["2187", "2197", "2207", "2217"], correct: 1, category: "Math", difficulty: "Hard", points: 10 },
            { id: 165, q: "What is ‚àö225?", options: ["13", "14", "15", "16"], correct: 2, category: "Math", difficulty: "Hard", points: 10 },
            { id: 166, q: "What is 999 + 888 + 777?", options: ["2554", "2664", "2774", "2884"], correct: 1, category: "Math", difficulty: "Hard", points: 10 },
            { id: 167, q: "What is 48 √ó 12?", options: ["566", "576", "586", "596"], correct: 1, category: "Math", difficulty: "Hard", points: 10 },
            { id: 168, q: "What is 1440 √∑ 48?", options: ["28", "29", "30", "31"], correct: 2, category: "Math", difficulty: "Hard", points: 10 },
            { id: 169, q: "What is 35% of 280?", options: ["88", "92", "98", "102"], correct: 2, category: "Math", difficulty: "Hard", points: 10 },
            { id: 170, q: "What is ‚àö289?", options: ["15", "16", "17", "18"], correct: 2, category: "Math", difficulty: "Hard", points: 10 },

            // GENERAL KNOWLEDGE - Hard (10 questions)
            { id: 171, q: "Who invented the printing press?", options: ["Da Vinci", "Newton", "Gutenberg", "Edison"], correct: 2, category: "GK", difficulty: "Hard", points: 10 },
            { id: 172, q: "Which year did Titanic sink?", options: ["1910", "1911", "1912", "1913"], correct: 2, category: "GK", difficulty: "Hard", points: 10 },
            { id: 173, q: "Noble gas with atomic number 18?", options: ["Neon", "Argon", "Krypton", "Xenon"], correct: 1, category: "GK", difficulty: "Hard", points: 10 },
            { id: 174, q: "Author of 'War and Peace'?", options: ["Dostoevsky", "Tolstoy", "Chekhov", "Pushkin"], correct: 1, category: "GK", difficulty: "Hard", points: 10 },
            { id: 175, q: "Longest bone in human body?", options: ["Tibia", "Humerus", "Femur", "Radius"], correct: 2, category: "GK", difficulty: "Hard", points: 10 },
            { id: 176, q: "pH value of pure water?", options: ["6", "7", "8", "9"], correct: 1, category: "GK", difficulty: "Hard", points: 10 },
            { id: 177, q: "Currency of Switzerland?", options: ["Euro", "Franc", "Krone", "Mark"], correct: 1, category: "GK", difficulty: "Hard", points: 10 },
            { id: 178, q: "Highest waterfall in the world?", options: ["Niagara", "Victoria", "Angel", "Iguazu"], correct: 2, category: "GK", difficulty: "Hard", points: 10 },
            { id: 179, q: "Number of elements in periodic table?", options: ["108", "110", "116", "118"], correct: 3, category: "GK", difficulty: "Hard", points: 10 },
            { id: 180, q: "Smallest bone in human body?", options: ["Stapes", "Incus", "Malleus", "Hammer"], correct: 0, category: "GK", difficulty: "Hard", points: 10 },

            // LOGIC & REASONING - Hard (10 questions)
            { id: 181, q: "If 5 workers build 1 house in 10 days, how many workers for 5 houses in 10 days?", options: ["10", "15", "20", "25"], correct: 3, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 182, q: "Missing: 2,6,12,20,30,? (n¬≤+n)", options: ["40", "42", "44", "46"], correct: 1, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 183, q: "If DEAR=1324 and FEAR=5324, what is FARE?", options: ["5314", "5341", "5134", "5143"], correct: 0, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 184, q: "Series: 3,7,15,31,63,? (2n+1)", options: ["125", "126", "127", "128"], correct: 2, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 185, q: "Which doesn't belong: 16,25,36,48,64?", options: ["16", "25", "48", "64"], correct: 2, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 186, q: "Next: 1,1,2,6,24,? (factorial pattern)", options: ["100", "110", "120", "130"], correct: 2, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 187, q: "If all Bloops are Razzies and all Razzies are Lazzies, then all Bloops are definitely?", options: ["Wazzies", "Lazzies", "Fazzies", "Unknown"], correct: 1, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 188, q: "Pattern: 1,8,27,64,125,? (cubes)", options: ["186", "196", "206", "216"], correct: 3, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 189, q: "Missing number: 2,3,5,7,11,13,? (primes)", options: ["15", "16", "17", "18"], correct: 2, category: "Logic", difficulty: "Hard", points: 10 },
            { id: 190, q: "If BAD=214, CAB=312, what is DECADE?", options: ["454214", "413124", "145124", "451214"], correct: 0, category: "Logic", difficulty: "Hard", points: 10 },

            // ENGLISH - Medium (10 questions)
            { id: 191, q: "Synonym of Generous?", options: ["Selfish", "Liberal", "Greedy", "Mean"], correct: 1, category: "English", difficulty: "Medium", points: 7 },
            { id: 192, q: "Antonym of Ancient?", options: ["Old", "Modern", "Historic", "Classic"], correct: 1, category: "English", difficulty: "Medium", points: 7 },
            { id: 193, q: "Which is correctly spelled?", options: ["Occassion", "Occasion", "Ocassion", "Occacion"], correct: 1, category: "English", difficulty: "Medium", points: 7 },
            { id: 194, q: "Idiom: 'Break the ice' means?", options: ["To freeze", "To initiate", "To break", "To cool"], correct: 1, category: "English", difficulty: "Medium", points: 7 },
            { id: 195, q: "Collective noun for lions?", options: ["Pack", "Herd", "Pride", "Flock"], correct: 2, category: "English", difficulty: "Medium", points: 7 },
            { id: 196, q: "Synonym of Absurd?", options: ["Sensible", "Logical", "Ridiculous", "Reasonable"], correct: 2, category: "English", difficulty: "Medium", points: 7 },
            { id: 197, q: "Antonym of Temporary?", options: ["Brief", "Short", "Permanent", "Quick"], correct: 2, category: "English", difficulty: "Medium", points: 7 },
            { id: 198, q: "Past participle of 'Drink'?", options: ["Drank", "Drunk", "Drinked", "Drink"], correct: 1, category: "English", difficulty: "Medium", points: 7 },
            { id: 199, q: "'Piece of cake' means?", options: ["Dessert", "Easy", "Sweet", "Difficult"], correct: 1, category: "English", difficulty: "Medium", points: 7 },
            { id: 200, q: "Synonym of Evident?", options: ["Hidden", "Obscure", "Obvious", "Vague"], correct: 2, category: "English", difficulty: "Medium", points: 7 },

            // TECHNOLOGY - Medium (10 questions)
            { id: 201, q: "Binary for decimal 10?", options: ["1000", "1001", "1010", "1011"], correct: 2, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 202, q: "Creator of Linux?", options: ["Bill Gates", "Steve Jobs", "Linus Torvalds", "Mark Zuckerberg"], correct: 2, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 203, q: "HTTP stands for?", options: ["Hypertext Transfer Protocol", "Hyperlink Transfer Protocol", "Hypertext Transport Protocol", "Hyperlink Transport Protocol"], correct: 0, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 204, q: "Which language is Python?", options: ["Low-level", "Assembly", "High-level", "Machine"], correct: 2, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 205, q: "Founder of Facebook?", options: ["Bill Gates", "Mark Zuckerberg", "Steve Jobs", "Elon Musk"], correct: 1, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 206, q: "SQL stands for?", options: ["Structured Query Language", "Simple Query Language", "Structured Question Language", "Simple Question Language"], correct: 0, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 207, q: "Which protocol for sending email?", options: ["FTP", "HTTP", "SMTP", "TCP"], correct: 2, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 208, q: "First computer programmer?", options: ["Grace Hopper", "Ada Lovelace", "Alan Turing", "Charles Babbage"], correct: 1, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 209, q: "JSON stands for?", options: ["JavaScript Object Notation", "Java System Object Notation", "JavaScript Online Notation", "Java Standard Object Notation"], correct: 0, category: "Tech", difficulty: "Medium", points: 7 },
            { id: 210, q: "Year iPhone was released?", options: ["2005", "2006", "2007", "2008"], correct: 2, category: "Tech", difficulty: "Medium", points: 7 }
        ];

        // Quiz state
        let currentQuizSession = [];
        let quizIndex = 0;
        let quizScore = 0;
        let quizMaxScore = 0;

        // Fisher-Yates Shuffle Algorithm
        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Get recently played questions from localStorage
        function getRecentQuestions() {
            try {
                const stored = localStorage.getItem('quiz_recent_questions');
                return stored ? JSON.parse(stored) : [];
            } catch {
                return [];
            }
        }

        // Save recently played questions
        function saveRecentQuestion(questionId) {
            try {
                let recent = getRecentQuestions();
                recent.unshift(questionId);
                // Keep only last 50 questions
                if (recent.length > 50) recent = recent.slice(0, 50);
                localStorage.setItem('quiz_recent_questions', JSON.stringify(recent));
            } catch (e) {
                console.error("Failed to save recent question:", e);
            }
        }

        // Select random questions with balanced difficulty
        function selectQuizQuestions(count = 10) {
            const recentIds = getRecentQuestions();

            // Filter out recently played questions
            const availableQuestions = QUIZ_QUESTION_POOL.filter(q => !recentIds.includes(q.id));

            // If less than count available, use entire pool
            const pool = availableQuestions.length >= count ? availableQuestions : QUIZ_QUESTION_POOL;

            // Shuffle the pool
            const shuffled = shuffleArray(pool);

            // Select balanced mix: 4 Easy, 4 Medium, 2 Hard
            const easyQuestions = shuffled.filter(q => q.difficulty === "Easy");
            const mediumQuestions = shuffled.filter(q => q.difficulty === "Medium");
            const hardQuestions = shuffled.filter(q => q.difficulty === "Hard");

            const selected = [
                ...easyQuestions.slice(0, 4),
                ...mediumQuestions.slice(0, 4),
                ...hardQuestions.slice(0, 2)
            ];

            // Shuffle the final selection
            return shuffleArray(selected);
        }

        function startQuiz() {
            quizScore = 0;
            quizIndex = 0;

            // Select random questions for this session
            currentQuizSession = selectQuizQuestions(10);
            quizMaxScore = currentQuizSession.reduce((sum, q) => sum + q.points, 0);

            document.getElementById('quizScore').textContent = `Score: 0/${quizMaxScore}`;
            document.getElementById('quizResult').innerHTML = '';
            document.getElementById('quizPostGame').classList.remove('show');

            showQuestion();
        }

        function showQuestion() {
            if (quizIndex >= currentQuizSession.length) {
                endQuiz();
                return;
            }

            const q = currentQuizSession[quizIndex];

            // Save to recent history
            saveRecentQuestion(q.id);

            // SHUFFLE OPTIONS to randomize correct answer position
            const shuffledOptions = q.options.map((opt, idx) => ({ text: opt, originalIndex: idx }));
            for (let i = shuffledOptions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledOptions[i], shuffledOptions[j]] = [shuffledOptions[j], shuffledOptions[i]];
            }

            // Find new position of correct answer after shuffle
            const newCorrectIndex = shuffledOptions.findIndex(opt => opt.originalIndex === q.correct);

            // Store shuffled data for answer checking
            currentQuizSession[quizIndex].shuffledOptions = shuffledOptions;
            currentQuizSession[quizIndex].shuffledCorrect = newCorrectIndex;

            // Update UI with progress and metadata
            const difficultyColor = q.difficulty === "Easy" ? "#10b981" : q.difficulty === "Medium" ? "#f59e0b" : "#ef4444";
            const categoryEmoji = {
                "Math": "üî¢",
                "GK": "üåç",
                "Logic": "üß©",
                "English": "üìö",
                "Tech": "üíª",
                "Science": "üî¨"
            };

            document.getElementById('quizQuestion').innerHTML = `
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;flex-wrap:wrap;gap:8px;">
                    <span style="font-size:12px;color:#666;">Question ${quizIndex + 1} of ${currentQuizSession.length}</span>
                    <div style="display:flex;gap:8px;flex-wrap:wrap;">
                        <span style="font-size:11px;padding:3px 8px;background:${difficultyColor};color:white;border-radius:12px;font-weight:600;">${q.difficulty}</span>
                        <span style="font-size:11px;padding:3px 8px;background:#6366f1;color:white;border-radius:12px;">${categoryEmoji[q.category] || ""} ${q.category}</span>
                        <span style="font-size:11px;padding:3px 8px;background:#10b981;color:white;border-radius:12px;">+${q.points} pts</span>
                    </div>
                </div>
                <div style="font-size:16px;font-weight:600;color:#333;margin-top:8px;">${q.q}</div>
            `;

            // Display shuffled options
            document.getElementById('quizOptions').innerHTML = shuffledOptions.map((opt, i) =>
                `<button class="quiz-option" onclick="answerQuiz(${i})">${opt.text}</button>`
            ).join('');
        }

        function answerQuiz(index) {
            const q = currentQuizSession[quizIndex];
            const correctIndex = q.shuffledCorrect; // Use shuffled position
            const buttons = document.querySelectorAll('.quiz-option');

            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === correctIndex) btn.classList.add('correct');
                else if (i === index) btn.classList.add('wrong');
            });

            if (index === correctIndex) {
                quizScore += q.points;
            }

            document.getElementById('quizScore').textContent = `Score: ${quizScore}/${quizMaxScore}`;

            setTimeout(() => {
                quizIndex++;
                showQuestion();
            }, 1000);
        }

        async function endQuiz() {
            document.getElementById('quizQuestion').innerHTML = `
                <div style="text-align:center;font-size:20px;font-weight:bold;color:#6366f1;">
                    üéì Quiz Complete!
                </div>
            `;
            document.getElementById('quizOptions').innerHTML = '';

            const resultEl = document.getElementById('quizResult');
            const reward = quizScore;

            if (reward > 0) {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üß†</div>
                        <div class="result-score">Score: ${quizScore}/${quizMaxScore}</div>
                        <div class="result-reward processing">Verifying...</div>
                    </div>
                `;

                const earned = await submitReward('quiz', quizScore, reward, null);

                if (earned > 0) {
                    const percentage = Math.round((quizScore / quizMaxScore) * 100);
                    const grade = percentage >= 90 ? "A+" : percentage >= 80 ? "A" : percentage >= 70 ? "B" : percentage >= 60 ? "C" : "D";

                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üéâ</div>
                            <div class="result-score">Score: ${quizScore}/${quizMaxScore} (${percentage}%)</div>
                            <div style="font-size:24px;font-weight:bold;color:#6366f1;margin:8px 0;">Grade: ${grade}</div>
                            <div class="result-reward win">‚úì +${earned} Coins Added!</div>
                            <div class="result-message">Brilliant work!</div>
                        </div>
                    `;
                    document.getElementById('quizPostGame').classList.add('show');
                } else {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">‚ùå</div>
                            <div class="result-score">Score: ${quizScore}/${quizMaxScore}</div>
                            <div class="result-reward lose">Reward Failed</div>
                            <div class="result-message">Could not add coins</div>
                        </div>
                    `;
                }
            } else {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üòî</div>
                        <div class="result-score">Score: 0/${quizMaxScore}</div>
                        <div class="result-reward lose">Reward: 0 Coins</div>
                        <div class="result-message">Study harder next time!</div>
                    </div>
                `;
                resultEl.innerHTML += `<button onclick="startQuiz()" class="action-btn" style="margin-top:10px;">TRY AGAIN</button>`;
            }
        }

        // === CATCH GAME ===
        let catchScore = 0, catchActive = false, catchInterval, catchMoveInterval;

        function resetCatchGame() {
            catchScore = 0;
            catchActive = false;
            clearInterval(catchInterval);
            clearInterval(catchMoveInterval);
            document.getElementById('catchScore').textContent = 'Caught: 0';
            document.getElementById('catchTimer').textContent = '10s';
            document.getElementById('catchResult').textContent = '';
            document.getElementById('catchBtn').disabled = false;
            document.getElementById('catchBtn').textContent = 'START';
            document.getElementById('catchBtn').classList.remove('claimed');
            document.getElementById('catchPostGame').classList.remove('show');
        }

        function startCatch() {
            catchScore = 0;
            catchActive = true;
            document.getElementById('catchScore').textContent = 'Caught: 0';
            document.getElementById('catchResult').textContent = '';
            document.getElementById('catchBtn').disabled = true;
            document.getElementById('catchBtn').textContent = 'Catching...';
            moveTarget();

            catchMoveInterval = setInterval(moveTarget, 800);

            let timeLeft = 10;
            document.getElementById('catchTimer').textContent = timeLeft + 's';
            catchInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('catchTimer').textContent = timeLeft + 's';
                if (timeLeft <= 0) {
                    clearInterval(catchInterval);
                    clearInterval(catchMoveInterval);
                    endCatch();
                }
            }, 1000);
        }

        function moveTarget() {
            if (!catchActive) return;
            const area = document.getElementById('catchArea');
            const target = document.getElementById('catchTarget');
            const maxX = area.offsetWidth - 50;
            const maxY = area.offsetHeight - 50;
            target.style.left = Math.random() * maxX + 'px';
            target.style.top = Math.random() * maxY + 'px';
        }

        function catchClick() {
            if (!catchActive) return;
            catchScore++;
            document.getElementById('catchScore').textContent = 'Caught: ' + catchScore;
            moveTarget();
        }

        async function endCatch() {
            catchActive = false;
            let reward = 0;
            let requirement = '3+ Caught';
            if (catchScore >= 10) { reward = 20; requirement = '10+ Caught (MAX)'; }
            else if (catchScore >= 5) { reward = 15; requirement = '5+ Caught'; }
            else if (catchScore >= 3) { reward = 10; requirement = '3+ Caught'; }

            const resultEl = document.getElementById('catchResult');

            if (reward > 0) {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üé£</div>
                        <div class="result-score">Caught: ${catchScore}</div>
                        <div class="result-requirement">Requirement: ${requirement}</div>
                        <div class="result-reward processing">Verifying...</div>
                    </div>
                `;

                const earned = await submitReward('catch', catchScore, reward, 'catchBtn');

                if (earned > 0) {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">üéâ</div>
                            <div class="result-score">Caught: ${catchScore}</div>
                            <div class="result-requirement">Requirement: ${requirement}</div>
                            <div class="result-reward win">‚úì +${earned} Coins Added!</div>
                            <div class="result-message">Great catching!</div>
                        </div>
                    `;
                    document.getElementById('catchPostGame').classList.add('show');
                } else {
                    resultEl.innerHTML = `
                        <div class="game-result-box">
                            <div class="result-emoji">‚ùå</div>
                            <div class="result-score">Caught: ${catchScore}</div>
                            <div class="result-reward lose">Reward Failed</div>
                            <div class="result-message">Could not add coins</div>
                        </div>
                    `;
                }
            } else {
                resultEl.innerHTML = `
                    <div class="game-result-box">
                        <div class="result-emoji">üòî</div>
                        <div class="result-score">Caught: ${catchScore}</div>
                        <div class="result-requirement">Need 3+ to earn</div>
                        <div class="result-reward lose">Reward: 0 Coins</div>
                        <div class="result-message">Keep trying!</div>
                    </div>
                `;
                document.getElementById('catchBtn').disabled = false;
                document.getElementById('catchBtn').textContent = 'TRY AGAIN';
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // Initialize
        loadGamesStatus();
    </script>
</body>

</html>
